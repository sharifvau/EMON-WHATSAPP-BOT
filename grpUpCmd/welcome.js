module.exports = {
  event: 'add',
  handle: async ({ api, event }) => {
    const newMembers = event.participants;
    const groupInfo = await api.groupMetadata(event.id);
    const groupName = groupInfo.subject;
    const totalMembers = groupInfo.participants.length;

    const welcomeTexts = [
      "ржЖржЬ ржерзЗржХрзЗ ржПржЗ ржЧрзНрж░рзБржк рждрзЛржорж╛рж░ ржжрзНржмрж┐рждрзАржпрж╝ ржкрж░рж┐ржмрж╛рж░, ржоржи ржЦрзБрж▓рзЗ ржХржерж╛ ржмрж▓рзЛ! ЁЯдЧЁЯПб",
      "рждрзЛржорж╛ржХрзЗ ржкрзЗржпрж╝рзЗ ржЧрзНрж░рзБржк ржЖрж░ржУ рж╕рзБржирзНржжрж░ рж╣ржпрж╝рзЗ ржЧрзЗрж▓! ЁЯМ╕тЬи",
      "ржПржЗ ржЧрзНрж░рзБржкрзЗ ржПрж╕рзЗржЫрзЛ ржорж╛ржирзЗржЗ VIP ржПржирзНржЯрзНрж░рж┐! ЁЯШОЁЯОЯя╕П",
      "рждрзЛржорж╛рж░ ржЖржЧржоржирзЗ ржЧрзНрж░рзБржкрзЗ ржирждрзБржи рж░ржЩ рж▓рж╛ржЧрж▓рзЛ! ЁЯОиЁЯМИ",
      "рж╕рзНржмрж╛ржЧрждржо! ржПржЦржи ржерзЗржХрзЗ рждрзБржорж┐ ржЖржорж╛ржжрзЗрж░ржЗ ржПржХржЬржи! ЁЯдЭтЭдя╕П",
      "рждрзЛржорж╛ржХрзЗ ржкрзЗржпрж╝рзЗ ржЧрзНрж░рзБржкрзЗрж░ ржнрж╛ржЗржм ржЧрзБржгрзЗ ржЧрзБржгрзЗ ржмрзЗржбрж╝рзЗ ржЧрзЗрж▓! ЁЯФеЁЯУИ",
      "ржПржЗ ржЧрзНрж░рзБржк ржПржЦржи ржЖрж░ржУ ржЬржоржЬржорж╛ржЯ рж╣ржмрзЗ! ЁЯе│ЁЯОЙ",
      "рждрзЛржорж╛рж░ ржЖржЧржоржирзЗ ржЧрзНрж░рзБржкрзЗ ржЦрзБрж╢рж┐рж░ ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи ржмрж╛ржЬрж▓рзЛ! ЁЯФФЁЯШД",
      "рж╕рзНржмрж╛ржЧрждржо ржмржирзНржзрзБ, ржПржЦрж╛ржирзЗ рж╕ржмрж╛ржЗ ржЖржкржиржЬржи! ЁЯл╢ЁЯШК",
      "рждрзЛржорж╛ржХрзЗ ржкрзЗржпрж╝рзЗ ржЧрзНрж░рзБржкрзЗ ржирждрзБржи ржкрзНрж░рж╛ржг ржлрж┐рж░рзЗ ржПрж▓рзЛ! ЁЯМ▒ЁЯТЪ",

      "ржПржЗ ржЧрзНрж░рзБржкрзЗ ржПрж╕рзЗржЫрзЛ ржорж╛ржирзЗржЗ ржоржЬрж╛ рж╢рзБрж░рзБ! ЁЯШЖЁЯОК",
      "рждрзЛржорж╛рж░ ржЖржЧржоржирзЗ ржЧрзНрж░рзБржкрзЗ рж░рзЛржжрзНржжрзБрж░рзЗрж░ ржорждрзЛ ржЖрж▓рзЛ! тШАя╕ПтЬи",
      "рж╕рзНржмрж╛ржЧрждржо! ржПржЦржи ржерзЗржХрзЗ рждрзБржорж┐ржУ ржЖржорж╛ржжрзЗрж░ ржЧрж▓рзНржкрзЗрж░ ржЕржВрж╢! ЁЯУЦЁЯТл",
      "рждрзЛржорж╛ржХрзЗ ржкрзЗржпрж╝рзЗ ржЧрзНрж░рзБржк ржЖрж░ржУ ржлрзНрж░рзЗрж╢ рж▓рж╛ржЧржЫрзЗ! ЁЯНГЁЯШМ",
      "ржПржЗ ржЧрзНрж░рзБржкрзЗ рждрзБржорж┐ ржорж╛ржирзЗржЗ рж╕рзНржкрзЗрж╢рж╛рж▓ ржХрзЗржЙ! ЁЯМЯЁЯСС",
      "рж╕рзНржмрж╛ржЧрждржо! ржЖрж╢рж╛ ржХрж░рж┐ ржПржЦрж╛ржирзЗ рж╕рзБржирзНржжрж░ рж╕ржоржпрж╝ ржХрж╛ржЯржмрзЗ! тП│ЁЯТЦ",
      "рждрзЛржорж╛рж░ ржЖржЧржоржирзЗ ржЧрзНрж░рзБржкрзЗ ржорж┐рж╖рзНржЯрж┐ рж╣рж╛рж╕рж┐ ржпрзЛржЧ рж╣рж▓рзЛ! ЁЯШКЁЯНм",
      "ржПржЗ ржЧрзНрж░рзБржкрзЗ ржПрж╕рзЗржЫрзЛ ржорж╛ржирзЗржЗ рж╕ржарж┐ржХ ржЬрж╛ржпрж╝ржЧрж╛ржпрж╝ ржПрж╕рзЗржЫрзЛ! ЁЯУНтЬЕ",
      "рж╕рзНржмрж╛ржЧрждржо ржмржирзНржзрзБ, ржПржЦрж╛ржирзЗ рж╕ржмрж╛ржЗ рждрзЛржорж╛рж░ ржкрж╛рж╢рзЗ! ЁЯдЧЁЯЫбя╕П",
      "рждрзЛржорж╛ржХрзЗ ржкрзЗржпрж╝рзЗ ржЧрзНрж░рзБржк ржЖрж░ржУ ржЬрзАржмржирзНржд рж╣ржпрж╝рзЗ ржЙржарж▓рзЛ! тЪбЁЯТГ",

      "ржПржЗ ржЧрзНрж░рзБржкрзЗ рждрзЛржорж╛рж░ ржЬржирзНржп рж╕ржмрж╕ржоржпрж╝ ржЬрж╛ржпрж╝ржЧрж╛ ржЖржЫрзЗ! ЁЯкСЁЯТЩ",
      "рж╕рзНржмрж╛ржЧрждржо! ржПржЦржи ржерзЗржХрзЗ рждрзБржорж┐ржУ ржЖржорж╛ржжрзЗрж░ ржЯрж┐ржорзЗрж░ ржЕржВрж╢! ЁЯзйЁЯдЭ",
      "рждрзЛржорж╛рж░ ржЖржЧржоржирзЗ ржЧрзНрж░рзБржкрзЗ ржирждрзБржи рж╢ржХрзНрждрж┐ ржПрж▓рзЛ! ЁЯТктЪб",
      "ржПржЗ ржЧрзНрж░рзБржкрзЗ ржПрж╕рзЗржЫрзЛ ржорж╛ржирзЗржЗ ржЖржиржирзНржж рж╢рзБрж░рзБ! ЁЯШНЁЯОИ",
      "рж╕рзНржмрж╛ржЧрждржо ржмржирзНржзрзБ, ржПржЦрж╛ржирзЗ рж╕ржмрж╛ржЗ ржлрзНржпрж╛ржорж┐рж▓рж┐! ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСжтЭдя╕П",
      "рждрзЛржорж╛ржХрзЗ ржкрзЗржпрж╝рзЗ ржЧрзНрж░рзБржк ржЖрж░ржУ рж╕рзБржирзНржжрж░ рж▓рж╛ржЧржЫрзЗ! ЁЯМ╝ЁЯШК",
      "ржПржЗ ржЧрзНрж░рзБржкрзЗ рждрзБржорж┐ ржЖрж╕рж╛ржпрж╝ ржЖржорж░рж╛ ржЦрзБрж╢рж┐! ЁЯШДЁЯОЙ",
      "рж╕рзНржмрж╛ржЧрждржо! ржПржЦрж╛ржирзЗ рждрзЛржорж╛рж░ ржЙржкрж╕рзНржерж┐рждрж┐ ржЖржорж╛ржжрзЗрж░ ржЬржирзНржп ржорзВрж▓рзНржпржмрж╛ржи! ЁЯТОЁЯЩП",
      "рждрзЛржорж╛рж░ ржЖржЧржоржирзЗ ржЧрзНрж░рзБржкрзЗ ржнрж╛рж▓рзЛржмрж╛рж╕рж╛ ржмрзЗржбрж╝рзЗ ржЧрзЗрж▓! ЁЯТХЁЯУИ",
      "ржПржЗ ржЧрзНрж░рзБржкрзЗ рждрзБржорж┐ ржорж╛ржирзЗржЗ ржирждрзБржи ржЖржиржирзНржж! ЁЯШБЁЯО╢",

      "рж╕рзНржмрж╛ржЧрждржо ржмржирзНржзрзБ, ржПржЦрж╛ржирзЗ рж╕ржмрж╕ржоржпрж╝ ржкржЬрж┐ржЯрж┐ржн ржнрж╛ржЗржм! тЬиЁЯШЗ",
      "рждрзЛржорж╛ржХрзЗ ржкрзЗржпрж╝рзЗ ржЧрзНрж░рзБржк ржЖрж░ржУ рж░ржЩрж┐ржи рж╣ржпрж╝рзЗ ржЙржарж▓рзЛ! ЁЯМИЁЯОи",
      "ржПржЗ ржЧрзНрж░рзБржкрзЗ ржПрж╕рзЗржЫрзЛ ржорж╛ржирзЗржЗ ржирждрзБржи рж╢рзБрж░рзБ! ЁЯЪАЁЯМЯ",
      "рж╕рзНржмрж╛ржЧрждржо! ржЖрж╢рж╛ ржХрж░рж┐ ржПржЦрж╛ржирзЗ ржЕржирзЗржХ ржнрж╛рж▓рзЛ рж╕ржоржпрж╝ ржпрж╛ржмрзЗ! ЁЯХКя╕ПЁЯШК",
      "рждрзЛржорж╛рж░ ржЖржЧржоржирзЗ ржЧрзНрж░рзБржкрзЗ рж╣рж╛рж╕рж┐рж░ ржмрзГрж╖рзНржЯрж┐! ЁЯШВЁЯМзя╕П",
      "ржПржЗ ржЧрзНрж░рзБржкрзЗ рждрзБржорж┐ ржерж╛ржХрж▓рзЗ ржоржЬрж╛ржЗ ржоржЬрж╛! ЁЯдкЁЯФе",
      "рж╕рзНржмрж╛ржЧрждржо ржмржирзНржзрзБ, ржПржЦрж╛ржирзЗ рж╕ржмрж╛ржЗ ржЖржкржиржЬржи! ЁЯлВЁЯТЦ",
      "рждрзЛржорж╛ржХрзЗ ржкрзЗржпрж╝рзЗ ржЧрзНрж░рзБржк ржЖрж░ржУ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА рж╣рж▓рзЛ! ЁЯЫбя╕ПЁЯТк",
      "ржПржЗ ржЧрзНрж░рзБржкрзЗ рждрзБржорж┐ ржорж╛ржирзЗржЗ ржнрж╛рж▓рзЛ ржХрж┐ржЫрзБ ржЖрж╕ржЫрзЗ! ЁЯМЯЁЯУм",
      "рж╕рзНржмрж╛ржЧрждржо! рждрзЛржорж╛рж░ рж╕рж╛ржерзЗ ржЧрзНрж░рзБржк ржЖрж░ржУ рж╕рзБржирзНржжрж░ рж╣ржмрзЗ! ЁЯМ╣ЁЯдЧ"
    ];

    for (const member of newMembers) {
      let profilePicUrl;
      try {
        profilePicUrl = await api.profilePictureUrl(member, 'image');
      } catch (error) {
        profilePicUrl = null;
      }

      const username = `@${member.split('@')[0]}`;
      const randomText =
        welcomeTexts[Math.floor(Math.random() * welcomeTexts.length)];

      const welcomeMessage =
        `ЁЯМ╕ рж╕рзНржмрж╛ржЧрждржо ${username} ЁЯМ╕\n\n` +
        `${randomText}\n\n` +
        `ЁЯП╖я╕П ржЧрзНрж░рзБржк: ${groupName}\n` +
        `ЁЯСе ржорзЛржЯ ржорзЗржорзНржмрж╛рж░: ${totalMembers}\n\n` +
        `тФАтФАтФАтФАтФАтФАтФАтФАтФАтФА\n` +
        `EMon-BHai`;

      if (profilePicUrl) {
        await api.sendMessage(event.id, {
          image: { url: profilePicUrl },
          caption: welcomeMessage,
          mentions: [member]
        });
      } else {
        await api.sendMessage(event.id, {
          text: welcomeMessage,
          mentions: [member]
        });
      }
    }
  }
};
